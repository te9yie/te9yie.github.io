{"pageProps":{"data":[{"id":"2021-03-03","content":"検索機能をつけたい。Google 検索ができればよいと思い設定してみる。\n\n[Programmable Search Engine](https://programmablesearchengine.google.com/)\n\n下記のコードをコピーして貼り付けてくれ、といわれたままやると `<div>` 自体が見えなくなってうまく動かなかった。\n\n```\n<script async src=\"https://cse.google.com/cse.js?cx=c961937a8b4f96e3d\"></script>\n<div class=\"gcse-search\"></div>\n```\n\nまあ [[React]] だから `<script>` あたりの処理がうまく動かないのかなと思った。\n\n`useEffect` で対応してみた。\n\n```typescript\nconst SearchBox: React.FC = () => {\n  const searchBoxRef = React.createRef<HTMLDivElement>();\n  useEffect(() => {\n    if (searchBoxRef && searchBoxRef.current) {\n      const searchBox = searchBoxRef.current;\n      const parent = searchBox.parentNode;\n      const gcse = document.createElement(\"script\");\n      gcse.async = true;\n      gcse.src = \"https://cse.google.com/cse.js?cx=c961937a8b4f96e3d\";\n      parent?.insertBefore(gcse, searchBox);\n    }\n  });\n  return (\n    <div className=\"search-box\">\n      <div ref={searchBoxRef} className=\"gcse-search\"></div>\n    </div>\n  );\n};\n```\n\nあと余白が大きくて邪魔だったので CSS も書いた。\n\n```css\n.gsc-control-cse {\n    padding: 0 !important;\n}\n```\n"},{"id":"2021-03-02","content":"引き続き [[JavaScript]] の勉強。\n\n[関数とthis · JavaScript Primer #jsprimer](https://jsprimer.net/basic/function-this/) を読んだ。\n\nアロー関数では `this` は静的スコープで解決され、それ以外の関数では暗黙の引数で `this` が渡されるようだ。`var` の変数の巻き上げ挙動も怖い。知らないと色々罠がありそうだ。\n\n[[TypeScript]] を学ぶにしても、基本の JavaScript の知識がないとダメなことが分かった。\n\n---\n\n開発環境として [[Docker]] を使ってみることにした。 [[VS Code]] から簡単に扱えるようなので試している。\n\n[Developing inside a Container using Visual Studio Code Remote Development](https://code.visualstudio.com/docs/remote/containers)\n\nWindows で `git clone` して Remote Container で開いたらファイルが軒並み変更がかかった。どうも改行コードらへんの扱いが怪しいらしい。と思ったら、そのものの解説があった。\n\n[Visual Studio Code Remote Development Troubleshooting Tips and Tricks](https://code.visualstudio.com/docs/remote/troubleshooting#_resolving-git-line-ending-issues-in-containers-resulting-in-many-modified-files)\n\n`.gitattributes` を追加することにした。\n\n```gitattributes\n* text=auto eol=lf\n```\n\n---\n\nいや、Windows 上で `git clone` せずに [[WSL]] 上でやって、そこから Remove Container を使うと大丈夫だ。\n"},{"id":"2021-03-01","content":"[[JavaScript]] 難しい。\n\n[Reactのイベント処理](https://ja.reactjs.org/docs/handling-events.html):\n\n> JSX のコールバックにおける this の意味に注意しなければなりません。JavaScript では、クラスのメソッドはデフォルトではバインドされません。this.handleClick へのバインドを忘れて onClick に渡した場合、実際に関数が呼ばれた時に this は undefined となってしまいます。\n\n意味が分からない。[[JavaScript]] では関数の定義方法が複数あって、それぞれ挙動が違うってことなんだと思う。\n\n[アロー関数 - JavaScript | MDN](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Functions/Arrow_functions) によると、メソッドでない関数はアロー関数式を使って定義したほうがよさそうだ。\n\n[[TypeScript]] の場合も、[アロー関数 - TypeScript Deep Dive 日本語版](https://typescript-jp.gitbook.io/deep-dive/future-javascript/arrow-functions)を読む感じ、基本的にはアロー関数を使ったほうがよさそうな気がする。\n\n`this` のバインドあたりの理解は大変そうだ。\n\n---\n\n「ネスレ 香るまろやか ミルクココア」がおいしい。`>>`[[好きなもの]]"}]},"__N_SSG":true}